<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Retirement Calculator</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <script src="{{ url_for('static', filename='script.js') }}" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <div class="container">

        <header>
            <h1>Retirement Calculator</h1>
        </header>

        <form id="calculation-form" method="POST" action="{{ url_for('index') }}">
            <label for="age">What's your current age?</label>
            <input type="number" id="age" name="age" required>

            <label for="retirement_age">What age do you plan to retire?</label>
            <input type="number" id="retirement_age" name="retirement_age" required>

            <label for="salary">What's your current annual household income? ($):</label>
            <input type="number" id="salary" name="salary" required>

            <label for="increase_percentage">How much do you expect your annual income to increase? (%):</label>
            <input type="number" id="increase_percentage" name="increase_percentage" required>

            <label for="retirement_so_far">How much have you saved for retirement so far? ($):</label>
            <input type="number" id="retirement_so_far" name="retirement_so_far" required>

            <label for="percentage_year_saved">How much do you plan to save each year for retirement? (%):</label>
            <input type="number" id="percentage_year_saved" name="percentage_year_saved" required>

            <label for="spend_in_retirement">How much money do you plan to spend each year in retirement? ($):</label>
            <input type="number" id="spend_in_retirement" name="spend_in_retirement" required>

            <label for="expected_return_before">Expected return on investments before retirement (%):</label>
            <input type="number" id="expected_return_before" name="expected_return_before" required>

            <label for="expected_return_during">Expected return on investments during retirement (%):</label>
            <input type="number" id="expected_return_during" name="expected_return_during" required>

            <button type="submit">Calculate</button>
        </form>

        <div id="results" class="results-section">
            <canvas id="savingsChart" width="400" height="200"></canvas>
        </div>

        <div id="saved-calculations" class="saved-section">
            {% if saved_calculations %}
            <h2>Saved Calculations</h2>
            <ul>
                {% for calculation in saved_calculations %}
                <li>{{ calculation.current_age }} to {{ calculation.retirement_age }}: ${{ calculation.balances[-1] }}
                </li>
                {% endfor %}
            </ul>
            {% endif %}
        </div>

    </div>

    <script>
        const retirementYears = {{ years | tojson | safe }};
        const retirementBalances = {{ balances | tojson | safe }};

        if (retirementYears.length > 0 && retirementBalances.length > 0) {
            const ctx = document.getElementById('savingsChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: retirementYears,
                    datasets: [{
                        label: 'Projected Savings',
                        data: retirementBalances,
                        borderColor: 'rgba(75, 192, 192, 1)',
                        backgroundColor: 'rgba(75, 192, 192, 0.2)',
                        fill: false,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Year'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Savings ($)'
                            },
                            beginAtZero: true
                        }
                    }
                }
            });
        }
    </script>

</body>

</html>